{"ast":null,"code":"var _jsxFileName = \"/Users/sagisimchi/Documents/GitHub/dent2-client/src/middleware/protected.tsx\",\n  _s = $RefreshSig$();\nimport React from \"react\";\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useRecoilValueLoadable } from \"recoil\";\nimport { userState } from \"../state/userState\";\nimport { validateUserAccess } from \"./validateUserAccess\";\nimport Preloader from \"../components/common/Preloader\";\nimport Link from \"../components/common/Link\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Protected = _ref => {\n  _s();\n  let {\n    children,\n    neededRole\n  } = _ref;\n  const userSelector = useRecoilValueLoadable(userState);\n  const location = useLocation();\n  switch (userSelector.state) {\n    case \"loading\":\n      return /*#__PURE__*/_jsxDEV(Preloader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 14\n      }, this);\n    case \"hasError\":\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: `/login?redirect=${encodeURIComponent(location.pathname + location.search)}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this);\n    case \"hasValue\":\n      const user = userSelector.getValue();\n      if (!user.isActive) {\n        return /*#__PURE__*/_jsxDEV(Navigate, {\n          to: `/complete-signup`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 16\n        }, this);\n      }\n      if (validateUserAccess(user.role, neededRole)) {\n        return children;\n      }\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You have no access to see this page :( \", /*#__PURE__*/_jsxDEV(Link, {\n          path: \"/\",\n          children: \"Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 50\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, this);\n  }\n};\n_s(Protected, \"k5I9+DcHseRqTsJZ5WQijXW9Z9Q=\", false, function () {\n  return [useRecoilValueLoadable, useLocation];\n});\n_c = Protected;\nexport default Protected;\nvar _c;\n$RefreshReg$(_c, \"Protected\");","map":{"version":3,"names":["React","Navigate","useLocation","useRecoilValueLoadable","userState","validateUserAccess","Preloader","Link","jsxDEV","_jsxDEV","Protected","_ref","_s","children","neededRole","userSelector","location","state","fileName","_jsxFileName","lineNumber","columnNumber","to","encodeURIComponent","pathname","search","user","getValue","isActive","role","path","_c","$RefreshReg$"],"sources":["/Users/sagisimchi/Documents/GitHub/dent2-client/src/middleware/protected.tsx"],"sourcesContent":["import React, { ReactElement } from \"react\";\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useRecoilValueLoadable } from \"recoil\";\nimport { userState } from \"../state/userState\";\nimport { validateUserAccess } from \"./validateUserAccess\";\nimport { UserRole } from \"../core/types/userRole\";\nimport Preloader from \"../components/common/Preloader\";\nimport Link from \"../components/common/Link\";\n\nconst Protected: React.FC<{\n  children: ReactElement;\n  neededRole?: UserRole;\n}> = ({ children, neededRole }) => {\n  const userSelector = useRecoilValueLoadable(userState);\n  const location = useLocation();\n  switch (userSelector.state) {\n    case \"loading\":\n      return <Preloader />;\n    case \"hasError\":\n      return (\n        <Navigate\n          to={`/login?redirect=${encodeURIComponent(\n            location.pathname + location.search\n          )}`}\n        />\n      );\n    case \"hasValue\":\n      const user = userSelector.getValue()!!;\n      if (!user.isActive) {\n        return <Navigate to={`/complete-signup`} />;\n      }\n\n      if (validateUserAccess(user.role, neededRole)) {\n        return children;\n      }\n      return (\n        <p>\n          You have no access to see this page :( <Link path=\"/\">Home</Link>\n        </p>\n      );\n  }\n};\nexport default Protected;\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAwB,OAAO;AAC3C,SAASC,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,SAASC,sBAAsB,QAAQ,QAAQ;AAC/C,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,kBAAkB,QAAQ,sBAAsB;AAEzD,OAAOC,SAAS,MAAM,gCAAgC;AACtD,OAAOC,IAAI,MAAM,2BAA2B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7C,MAAMC,SAGJ,GAAGC,IAAA,IAA8B;EAAAC,EAAA;EAAA,IAA7B;IAAEC,QAAQ;IAAEC;EAAW,CAAC,GAAAH,IAAA;EAC5B,MAAMI,YAAY,GAAGZ,sBAAsB,CAACC,SAAS,CAAC;EACtD,MAAMY,QAAQ,GAAGd,WAAW,CAAC,CAAC;EAC9B,QAAQa,YAAY,CAACE,KAAK;IACxB,KAAK,SAAS;MACZ,oBAAOR,OAAA,CAACH,SAAS;QAAAY,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IACtB,KAAK,UAAU;MACb,oBACEZ,OAAA,CAACR,QAAQ;QACPqB,EAAE,EAAG,mBAAkBC,kBAAkB,CACvCP,QAAQ,CAACQ,QAAQ,GAAGR,QAAQ,CAACS,MAC/B,CAAE;MAAE;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAEN,KAAK,UAAU;MACb,MAAMK,IAAI,GAAGX,YAAY,CAACY,QAAQ,CAAC,CAAG;MACtC,IAAI,CAACD,IAAI,CAACE,QAAQ,EAAE;QAClB,oBAAOnB,OAAA,CAACR,QAAQ;UAACqB,EAAE,EAAG;QAAkB;UAAAJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC;MAC7C;MAEA,IAAIhB,kBAAkB,CAACqB,IAAI,CAACG,IAAI,EAAEf,UAAU,CAAC,EAAE;QAC7C,OAAOD,QAAQ;MACjB;MACA,oBACEJ,OAAA;QAAAI,QAAA,GAAG,yCACsC,eAAAJ,OAAA,CAACF,IAAI;UAACuB,IAAI,EAAC,GAAG;UAAAjB,QAAA,EAAC;QAAI;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChE,CAAC;EAEV;AACF,CAAC;AAACT,EAAA,CAhCIF,SAGJ;EAAA,QACqBP,sBAAsB,EAC1BD,WAAW;AAAA;AAAA6B,EAAA,GALxBrB,SAGJ;AA8BF,eAAeA,SAAS;AAAC,IAAAqB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}